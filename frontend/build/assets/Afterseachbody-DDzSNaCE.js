import{R as P,r as b,j as e,D as J,P as j,G as en,x as nn}from"./index-C3ctIiJl.js";import{a as tn,c as sn}from"./index.esm-gWUCNikX.js";import{E as z,d as Y}from"./jspdf.plugin.autotable-BQsTSF12.js";import{B as I}from"./Box-FC9Y7n6T.js";import{P as X,T as V,I as K}from"./IconButton-Cmlk01-7.js";import{T as Q,a as Z,e as ee,c as D,d as u,b as ne}from"./TableRow-BTX8zteK.js";import{T as te,a as de,b as se,c as ie,v as ae}from"./TableSortLabel-Cj95AgCW.js";import{D as re,a as le,b as oe,c as ce}from"./DialogTitle-Bz9ZD_rg.js";import{f as B}from"./format-sbWH3_uq.js";import"./Accidentreport-Uqwb3blY.js";import"./exceljs.min-J6ZNXZRz.js";import{C as ue,a as ge}from"./CRow-DzVQe9d_.js";import"./createSvgIcon-CNOz48qt.js";import"./DefaultLayout-B0dSMtvQ.js";import"./cil-user-Ddrdy7PS.js";import"./dividerClasses-BVDnDaWy.js";import"./TextField-hedXIXYF.js";var an=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='497.333 239.999 80.092 239.999 176.087 144.004 153.46 121.377 18.837 256 153.46 390.623 176.087 367.996 80.09 271.999 497.333 271.999 497.333 239.999' class='ci-primary'/>"];function xe(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function rn(d,o){return d==="desc"?(t,c)=>xe(t,c,o):(t,c)=>-xe(t,c,o)}function ln(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const _e=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"issuance_id",numeric:!1,disablePadding:!0,label:"REF NO."},{id:"dresslist",numeric:!0,disablePadding:!1,label:"DRESS LIST"},{id:"issuedate",numeric:!0,disablePadding:!1,label:"ISSUED DATE"},{id:"nextissue",numeric:!0,disablePadding:!1,label:"NEXT ISSUANCE"},{id:"newIssuance_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function Ie(d){const{onSelectAllClick:o,order:t,orderBy:c,numSelected:h,rowCount:l,onRequestSort:g}=d,E=m=>_=>{g(_,m)};return e.jsx(ne,{children:e.jsx(D,{children:_e.map(m=>e.jsx(u,{align:m.numeric?"right":"left",padding:m.disablePadding?"none":"normal",sortDirection:c===m.id?t:!1,children:e.jsxs(ie,{active:c===m.id,direction:c===m.id?t:"asc",onClick:E(m.id),children:[m.label,c===m.id?e.jsx(I,{component:"span",sx:ae,children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},m.id))})})}Ie.propTypes={numSelected:j.number.isRequired,onRequestSort:j.func.isRequired,onSelectAllClick:j.func.isRequired,order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,rowCount:j.number.isRequired};function De(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"DRESS"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}De.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function on(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const i=await J.get(`/item/issued/?filter=Dress&employeeId=${o}`);console.log(i.data);const a=i.data.data.flatMap((s,x)=>s.items.map((S,N)=>({id:`${x}-${N}`,slno:N+1,issuance_id:S.issuance_id,dresslist:S.item_name,issuedate:B(new Date(S.issue_date),"dd/MM/yyyy"),nextissue:B(new Date(S.expiry_date),"dd/MM/yyyy"),newIssuance_image:S.newIssuance_image,about_the_newissuance:S.about_the_newissuance})));$(a)}catch(i){if(i.isAxiosError&&i.response){console.error(`HTTP error! status: ${i}`);const a=JSON.stringify(i.response.data);console.error("Response body:",a),alert(`Error: ${a}`)}console.error("Error fetching data:",i)}})()},[]);const L=(n,i)=>{c(h===i&&t==="asc"?"desc":"asc"),l(i)},q=n=>{if(n.target.checked){const i=p.map(a=>a.id);E(i);return}E([])},k=(n,i)=>{const a=g.indexOf(i);let s=[];a===-1?s=s.concat(g,i):a===0?s=s.concat(g.slice(1)):a===g.length-1?s=s.concat(g.slice(0,-1)):a>0&&(s=s.concat(g.slice(0,a),g.slice(a+1))),E(s)},w=(n,i)=>{_(i)},M=n=>{C(n),T(!0)},F=()=>{T(!1),C("")},R=n=>{W(parseInt(n.target.value,10)),_(0)},y=n=>g.indexOf(n)!==-1,v=m>0?Math.max(0,(1+m)*f-p.length):0,O=P.useMemo(()=>ln(p,rn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),r=()=>{const n=new z({orientation:"landscape"}),i=[["SL NO.","REF NO.","DRESS LIST","ISSUED DATE","NEXT ISSUANCE","IMAGE","DESCRIPTION"]],a=p.map(s=>[s.slno||"N/A",s.issuance_id||"N/A",s.dresslist||"N/A",s.issuedate||"N/A",s.nextissue||"N/A","",s.about_the_newissuance||"N/A"]);n.autoTable({head:i,body:a,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:8,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],fontSize:10},columnStyles:{0:{cellWidth:23},1:{cellWidth:28},2:{cellWidth:45},3:{cellWidth:38},4:{cellWidth:38},5:{cellWidth:48},6:{cellWidth:65}},margin:{right:20},didParseCell:s=>{s.section==="body"&&(s.cell.styles.minCellHeight=25)},didDrawCell:s=>{if(s.column.index===5){const x=p[s.row.index];if(x&&x.newIssuance_image){const S=`data:image/png;base64,${x.newIssuance_image}`,N=s.cell.width-6,G=s.cell.height-6,U=s.cell.x+3,he=s.cell.y+3;n.addImage(S,"PNG",U,he,N,G)}}}}),n.save("Dress_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(De,{numSelected:g.length,onPdfDownload:r}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Ie,{numSelected:g.length,order:t,orderBy:h,onSelectAllClick:q,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[O.map((n,i)=>{const a=y(n.id),s=`enhanced-table-checkbox-${i}`;return e.jsxs(D,{hover:!0,onClick:x=>k(x,n.id),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:s,scope:"row",padding:"none",children:n.slno}),e.jsx(u,{align:"left",children:n.issuance_id}),e.jsx(u,{align:"right",children:n.dresslist}),e.jsx(u,{align:"right",children:n.issuedate}),e.jsx(u,{align:"right",children:n.nextissue}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${n.newIssuance_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>M(`data:image/png;base64,${n.newIssuance_image}`),onError:x=>{x.target.onerror=null}})}),e.jsx(u,{align:"right",children:n.about_the_newissuance})]},n.id)}),v>0&&e.jsx(D,{style:{height:53*v},children:e.jsx(u,{colSpan:_e.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:w,onRowsPerPageChange:R})]}),e.jsxs(re,{open:H,onClose:F,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:F,style:{padding:"10px"},children:"Close"})})]})]})}function me(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function cn(d,o){return d==="desc"?(t,c)=>me(t,c,o):(t,c)=>-me(t,c,o)}function dn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const gn=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"issuance_id",numeric:!1,disablePadding:!0,label:"REF NO."},{id:"ppelist",numeric:!0,disablePadding:!1,label:"PPE LIST"},{id:"issuedate",numeric:!0,disablePadding:!1,label:"ISSUED DATE"},{id:"nextissue",numeric:!0,disablePadding:!1,label:"NEXT ISSUANCE"},{id:"newIssuance_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function Te(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:gn.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"7":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Te.propTypes={onRequestSort:j.func.isRequired,order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired};function Ce(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"PPE"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Ce.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function hn(d){const o=d.employee_id,[t,c]=b.useState("asc"),[h,l]=b.useState("slno"),[g,E]=b.useState([]),[m,_]=b.useState(0),[f,W]=b.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const i=await J.get(`/item/issued/?filter=PPE&employeeId=${o}`);console.log(i.data);const a=i.data.data.flatMap((s,x)=>s.items.map((S,N)=>({id:`${x}-${N}`,slno:N+1,issuance_id:S.issuance_id,ppelist:S.item_name,issuedate:B(new Date(S.issue_date),"dd/MM/yyyy"),nextissue:B(new Date(S.expiry_date),"dd/MM/yyyy"),newIssuance_image:S.newIssuance_image,about_the_newissuance:S.about_the_newissuance})));$(a)}catch(i){console.error("Error fetching data:",i)}})()},[]);const L=(n,i)=>{c(h===i&&t==="asc"?"desc":"asc"),l(i)},q=n=>{if(n.target.checked){const i=p.map(a=>a.id);E(i);return}E([])},k=n=>{C(n),T(!0)},w=()=>{T(!1),C("")},M=(n,i)=>{const a=g.indexOf(i);let s=[];a===-1?s=s.concat(g,i):a===0?s=s.concat(g.slice(1)):a===g.length-1?s=s.concat(g.slice(0,-1)):a>0&&(s=s.concat(g.slice(0,a),g.slice(a+1))),E(s)},F=(n,i)=>{_(i)},R=n=>{W(parseInt(n.target.value,10)),_(0)},y=n=>g.indexOf(n)!==-1,v=m>0?Math.max(0,(1+m)*f-p.length):0,O=P.useMemo(()=>dn(p,cn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),r=()=>{const n=new z({orientation:"landscape"}),i=[["SERIAL NO.","REF NO.","PPE LIST","ISSUED DATE","NEXT ISSUANCE","DESCRIPTION","IMAGE"]],a=p.map(s=>[s.slno,s.issuance_id,s.ppelist,s.issuedate,s.nextissue,s.about_the_newissuance,""]);n.autoTable({head:i,body:a,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:4,valign:"middle",halign:"center",overflow:"linebreak"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],fontStyle:"bold",fontSize:11},columnStyles:{0:{cellWidth:20},1:{cellWidth:30},2:{cellWidth:50},3:{cellWidth:40},4:{cellWidth:40},5:{cellWidth:70},6:{cellWidth:40}},didParseCell:s=>{s.section==="body"&&(s.cell.styles.minCellHeight=45)},didDrawCell:s=>{if(s.section==="body"&&s.column.index===6&&p[s.row.index].newIssuance_image){const x=`data:image/png;base64,${p[s.row.index].newIssuance_image}`,S=35,N=35,G=s.cell.x+(s.cell.width-S)/2,U=s.cell.y+(s.cell.height-N)/2;n.addImage(x,"PNG",G,U,S,N)}}}),n.save("PPE-report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2},children:[e.jsx(Ce,{numSelected:g.length,onPdfDownload:r}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",children:[e.jsx(Te,{numSelected:g.length,order:t,orderBy:h,onSelectAllClick:q,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[O.map((n,i)=>{const a=y(n.id),s=`enhanced-table-checkbox-${i}`;return e.jsxs(D,{hover:!0,onClick:x=>M(x,n.id),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[e.jsx(u,{component:"th",id:s,scope:"row",padding:"7",children:n.slno}),e.jsx(u,{align:"left",children:n.issuance_id}),e.jsx(u,{align:"right",children:n.ppelist}),e.jsx(u,{align:"right",children:n.issuedate}),e.jsx(u,{align:"right",children:n.nextissue}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${n.newIssuance_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>k(`data:image/png;base64,${n.newIssuance_image}`),onError:x=>{x.target.onerror=null}})}),e.jsx(u,{align:"right",children:n.about_the_newissuance})]},n.id)}),v>0&&e.jsx(D,{style:{height:53*v},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(re,{open:H,onClose:w,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:w,style:{padding:"10px"},children:"Close"})})]})]})}function pe(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function un(d,o){return d==="desc"?(t,c)=>pe(t,c,o):(t,c)=>-pe(t,c,o)}function xn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const mn=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"issuance_id",numeric:!1,disablePadding:!0,label:"Ref NO."},{id:"toollist",numeric:!0,disablePadding:!1,label:"TOOL LIST"},{id:"issuedate",numeric:!0,disablePadding:!1,label:"ISSUED DATE"},{id:"nextissue",numeric:!0,disablePadding:!1,label:"NEXT ISSUANCE"},{id:"newIssuance_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function Ne(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:mn.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"7":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Ne.propTypes={onRequestSort:j.func.isRequired,order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired};function Ae(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"TOOL"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Ae.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function pn(d){const o=d.employee_id,[t,c]=b.useState("asc"),[h,l]=b.useState("slno"),[g,E]=b.useState([]),[m,_]=b.useState(0),[f,W]=b.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const i=await J.get(`/item/issued/?filter=Tool&employeeId=${o}`);console.log(i.data);const a=i.data.data.flatMap((s,x)=>s.items.map((S,N)=>({id:`${x}-${N}`,slno:N+1,issuance_id:S.issuance_id,toollist:S.item_name,issuedate:S.issue_date?B(new Date(S.issue_date),"dd/MM/yyyy"):"N/A",nextissue:S.expiry_date?B(new Date(S.expiry_date),"dd/MM/yyyy"):"N/A",newIssuance_image:S.newIssuance_image,about_the_newissuance:S.about_the_newissuance})));$(a)}catch(i){console.error("Error fetching data:",i)}})()},[]);const L=(n,i)=>{c(h===i&&t==="asc"?"desc":"asc"),l(i)},q=n=>{if(n.target.checked){const i=p.map(a=>a.id);E(i);return}E([])},k=n=>{C(n),T(!0)},w=()=>{T(!1),C("")},M=(n,i)=>{const a=g.indexOf(i);let s=[];a===-1?s=s.concat(g,i):a===0?s=s.concat(g.slice(1)):a===g.length-1?s=s.concat(g.slice(0,-1)):a>0&&(s=s.concat(g.slice(0,a),g.slice(a+1))),E(s)},F=(n,i)=>{_(i)},R=n=>{W(parseInt(n.target.value,10)),_(0)},y=n=>g.indexOf(n)!==-1,v=m>0?Math.max(0,(1+m)*f-p.length):0,O=P.useMemo(()=>xn(p,un(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),r=()=>{const n=new z({orientation:"landscape"}),i=[["SERIAL NO.","REF NO.","TOOL LIST","ISSUED DATE","NEXT ISSUANCE","DESCRIPTION","IMAGE"]],a=p.map(s=>[s.slno||"N/A",s.issuance_id||"N/A",s.toollist||"N/A",s.issuedate||"N/A",s.nextissue||"N/A",s.about_the_newissuance||"N/A",""]);n.autoTable({head:i,body:a,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:10,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],halign:"center",fontSize:10},columnStyles:{0:{cellWidth:25},1:{cellWidth:30},2:{cellWidth:50},3:{cellWidth:40},4:{cellWidth:40},5:{cellWidth:70},6:{cellWidth:50}},didParseCell:s=>{s.section==="body"&&(s.cell.styles.minCellHeight=25)},didDrawCell:s=>{if(s.column.index===6){const x=p[s.row.index];if(x&&x.newIssuance_image){const S=`data:image/png;base64,${x.newIssuance_image}`,N=s.cell.width-6,G=s.cell.height-6,U=s.cell.x+3,he=s.cell.y+3;n.addImage(S,"PNG",U,he,N,G)}}}}),n.save("TOOL-report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2},children:[e.jsx(Ae,{numSelected:g.length,onPdfDownload:r}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",children:[e.jsx(Ne,{numSelected:g.length,order:t,orderBy:h,onSelectAllClick:q,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[O.map((n,i)=>{const a=y(n.id),s=`enhanced-table-checkbox-${i}`;return e.jsxs(D,{hover:!0,onClick:x=>M(x,n.id),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[e.jsx(u,{component:"th",id:s,scope:"row",padding:"7",children:n.slno}),e.jsx(u,{align:"left",children:n.issuance_id}),e.jsx(u,{align:"right",children:n.toollist}),e.jsx(u,{align:"right",children:n.issuedate}),e.jsx(u,{align:"right",children:n.nextissue}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${n.newIssuance_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>k(`data:image/png;base64,${n.newIssuance_image}`),onError:x=>{x.target.onerror=null}})}),e.jsx(u,{align:"right",children:n.about_the_newissuance})]},n.id)}),v>0&&e.jsx(D,{style:{height:53*v},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(re,{open:H,onClose:w,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:w,style:{padding:"10px"},children:"Close"})})]})]})}function fe(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function fn(d,o){return d==="desc"?(t,c)=>fe(t,c,o):(t,c)=>-fe(t,c,o)}function bn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const ve=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"trainername",numeric:!0,disablePadding:!1,label:"TRAINER NAME"},{id:"refrno",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"training_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function we(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:ve.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}we.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function ke(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"ToolBox Training"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}ke.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function jn(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const a=(await J.get(`/reports/employee/training/?filter=tool&employeeId=${o}`)).data.data["TOOL BOX TRAINING"];console.log("result:",a);const s=a.map((x,S)=>({slno:S+1,date:B(new Date(x.training_date),"dd/MM/yyyy"),trainername:x.trainers.map(N=>N.trainer_name).join(", "),refrno:x.training_id,training_image:x.training_image,description:x.about_the_training}));$(s)}catch(i){if(i.isAxiosError&&i.response){console.error(`/HTTP error! status: ${i}`);const a=JSON.stringify(i.response.data);console.error("Response body:",a),alert(`Error: ${a}`)}console.error("Error fetching data:",i)}})()},[]);const L=(n,i)=>{c(h===i&&t==="asc"?"desc":"asc"),l(i)},q=n=>{if(n.target.checked){const i=p.map(a=>a.id);E(i);return}E([])},k=n=>{C(n),T(!0)},w=()=>{T(!1),C("")},M=(n,i)=>{const a=g.indexOf(i);let s=[];a===-1?s=s.concat(g,i):a===0?s=s.concat(g.slice(1)):a===g.length-1?s=s.concat(g.slice(0,-1)):a>0&&(s=s.concat(g.slice(0,a),g.slice(a+1))),E(s)},F=(n,i)=>{_(i)},R=n=>{W(parseInt(n.target.value,10)),_(0)},y=n=>g.indexOf(n)!==-1,v=m>0?Math.max(0,(1+m)*f-p.length):0,O=P.useMemo(()=>bn(p,fn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),r=()=>{const n=new z({orientation:"landscape"}),i=[["SL NO.","DATE","TRAINER NAME","REFERENCE NUMBER","DESCRIPTION","IMAGE"]],a=p.map(s=>[s.slno||"N/A",s.date||"N/A",s.trainername||"N/A",s.refrno||"N/A",s.description||"N/A",""]);n.autoTable({head:i,body:a,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:8,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],fontSize:10},columnStyles:{0:{cellWidth:25},1:{cellWidth:30},2:{cellWidth:45},3:{cellWidth:45},4:{cellWidth:65},5:{cellWidth:50}},margin:{right:15},didParseCell:s=>{s.section==="body"&&(s.cell.styles.minCellHeight=25)},didDrawCell:s=>{if(s.section==="body"&&s.column.index===5){const x=p[s.row.index];if(x&&x.training_image){const S=`data:image/png;base64,${x.training_image}`,N=s.cell.width-6,G=s.cell.height-6,U=s.cell.x+3,he=s.cell.y+3;n.addImage(S,"PNG",U,he,N,G)}}}}),n.save("ToolBox_Training_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(ke,{numSelected:g.length,onPdfDownload:r}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(we,{order:t,orderBy:h,onRequestSort:L,onSelectAllClick:q,rowCount:p.length}),e.jsxs(ee,{children:[O.map((n,i)=>{const a=y(n.id),s=`enhanced-table-checkbox-${i}`;return e.jsxs(D,{hover:!0,onClick:x=>M(x,n.id),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:s,scope:"row",padding:"none",children:n.slno}),e.jsx(u,{align:"right",children:n.date}),e.jsx(u,{align:"right",children:n.trainername}),e.jsx(u,{align:"right",children:n.refrno}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${n.training_image}`,alt:"No Image",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>k(`data:image/png;base64,${n.training_image}`),onError:x=>{x.target.onerror=null}})}),e.jsx(u,{align:"right",children:n.description})]},n.id)}),v>0&&e.jsx(D,{style:{height:53*v},children:e.jsx(u,{colSpan:ve.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(re,{open:H,onClose:w,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:w,style:{padding:"10px"},children:"Close"})})]})]})}function be(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function Sn(d,o){return d==="desc"?(t,c)=>be(t,c,o):(t,c)=>-be(t,c,o)}function Pn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const Oe=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"trainername",numeric:!0,disablePadding:!1,label:"TRAINER NAME"},{id:"refrno",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"training_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function $e(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Oe.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}$e.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function qe(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"JobSafety Training"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}qe.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function yn(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const a=(await J.get(`reports/employee/training/?filter=safety&employeeId=${o}`)).data.data["JOB SAFETY TRAINING"];console.log("result:",a);const s=a.map((x,S)=>({slno:S+1,date:B(new Date(x.training_date),"dd/MM/yyyy"),trainername:x.trainers.map(N=>N.trainer_name).join(", "),refrno:x.training_id,training_image:x.training_image,description:x.about_the_training}));$(s)}catch(i){if(i.isAxiosError&&i.response){console.error(`HTTP error! status: ${i}`);const a=JSON.stringify(i.response.data);console.error("Response body:",a),alert(`Error: ${a}`)}console.error("Error fetching data:",i)}})()},[]);const L=(n,i)=>{c(h===i&&t==="asc"?"desc":"asc"),l(i)},q=n=>{if(n.target.checked){const i=p.map(a=>a.id);E(i);return}E([])},k=n=>{C(n),T(!0)},w=()=>{T(!1),C("")},M=(n,i)=>{const a=g.indexOf(i);let s=[];a===-1?s=s.concat(g,i):a===0?s=s.concat(g.slice(1)):a===g.length-1?s=s.concat(g.slice(0,-1)):a>0&&(s=s.concat(g.slice(0,a),g.slice(a+1))),E(s)},F=(n,i)=>{_(i)},R=n=>{W(parseInt(n.target.value,10)),_(0)},y=n=>g.indexOf(n)!==-1,v=m>0?Math.max(0,(1+m)*f-p.length):0,O=P.useMemo(()=>Pn(p,Sn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),r=()=>{const n=new z({orientation:"landscape"}),i=[["SL NO.","DATE","TRAINER NAME","REFERENCE NUMBER","DESCRIPTION","IMAGE"]],a=p.map(s=>[s.slno||"N/A",s.date||"N/A",s.trainername||"N/A",s.refrno||"N/A",s.description||"N/A",""]);n.autoTable({head:i,body:a,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:8,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],fontSize:10},columnStyles:{0:{cellWidth:25},1:{cellWidth:30},2:{cellWidth:45},3:{cellWidth:45},4:{cellWidth:65},5:{cellWidth:50}},margin:{right:15},didParseCell:s=>{s.section==="body"&&(s.cell.styles.minCellHeight=25)},didDrawCell:s=>{if(s.section==="body"&&s.column.index===5){const x=p[s.row.index];if(x&&x.training_image){const S=`data:image/png;base64,${x.training_image}`,N=s.cell.width-6,G=s.cell.height-6,U=s.cell.x+3,he=s.cell.y+3;n.addImage(S,"PNG",U,he,N,G)}}}}),n.save("JobSafety_Training_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(qe,{numSelected:g.length,onPdfDownload:r}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx($e,{order:t,orderBy:h,onSelectAllClick:q,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[O.map((n,i)=>{const a=y(n.id),s=`enhanced-table-checkbox-${i}`;return e.jsxs(D,{hover:!0,onClick:x=>M(x,n.id),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:s,scope:"row",padding:"none",children:n.slno}),e.jsx(u,{align:"right",children:n.date}),e.jsx(u,{align:"right",children:n.trainername}),e.jsx(u,{align:"right",children:n.refrno}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${n.training_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>k(`data:image/png;base64,${n.training_image}`),onError:x=>{x.target.onerror=null}})}),e.jsx(u,{align:"right",children:n.description})]},n.id)}),v>0&&e.jsx(D,{style:{height:53*v},children:e.jsx(u,{colSpan:Oe.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(re,{open:H,onClose:w,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:w,style:{padding:"10px"},children:"Close"})})]})]})}function je(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function Rn(d,o){return d==="desc"?(t,c)=>je(t,c,o):(t,c)=>-je(t,c,o)}function En(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const Me=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"trainername",numeric:!0,disablePadding:!1,label:"TRAINER NAME"},{id:"refrno",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"training_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function Fe(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Me.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Fe.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function We(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"Behavioral Training"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}We.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function _n(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const i=(await J.get(`/reports/employee/training/?filter=behavioral&employeeId=${o}`)).data.data["BEHAVIORAL TRAINING"];console.log("result:",i);const a=i.map((s,x)=>({slno:x+1,date:B(new Date(s.training_date),"dd/MM/yyyy"),trainername:s.trainers.map(S=>S.trainer_name).join(", "),refrno:s.training_id,training_image:s.training_image,description:s.about_the_training}));$(a)}catch(n){if(n.isAxiosError&&n.response){console.error(`HTTP error! status: ${n}`);const i=JSON.stringify(n.response.data);console.error("Response body:",i),alert(`Error: ${i}`)}console.error("Error fetching data:",n)}})()},[]);const L=(r,n)=>{c(h===n&&t==="asc"?"desc":"asc"),l(n)},q=r=>{C(r),T(!0)},k=()=>{T(!1),C("")},w=(r,n)=>{const i=g.indexOf(n);let a=[];i===-1?a=a.concat(g,n):i===0?a=a.concat(g.slice(1)):i===g.length-1?a=a.concat(g.slice(0,-1)):i>0&&(a=a.concat(g.slice(0,i),g.slice(i+1))),E(a)},M=(r,n)=>{_(n)},F=r=>{W(parseInt(r.target.value,10)),_(0)},R=r=>g.indexOf(r)!==-1,y=m>0?Math.max(0,(1+m)*f-p.length):0,v=P.useMemo(()=>En(p,Rn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),O=()=>{const r=new z({orientation:"landscape"}),n=[["SL NO.","DATE","TRAINER NAME","REFERENCE NUMBER","DESCRIPTION","IMAGE"]],i=p.map(a=>[a.slno||"N/A",a.date||"N/A",a.trainername||"N/A",a.refrno||"N/A",a.description||"N/A",""]);r.autoTable({head:n,body:i,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:8,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],fontSize:10},columnStyles:{0:{cellWidth:25},1:{cellWidth:30},2:{cellWidth:45},3:{cellWidth:45},4:{cellWidth:60},5:{cellWidth:50}},margin:{right:15},didParseCell:a=>{a.section==="body"&&(a.cell.styles.minCellHeight=25)},didDrawCell:a=>{if(a.section==="body"&&a.column.index===5){const s=p[a.row.index];if(s&&s.training_image){const x=`data:image/png;base64,${s.training_image}`,S=a.cell.width-6,N=a.cell.height-6,G=a.cell.x+3,U=a.cell.y+3;r.addImage(x,"PNG",G,U,S,N)}}}}),r.save("Behavioral_Training_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(We,{numSelected:g.length,onPdfDownload:O}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Fe,{order:t,orderBy:h,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[v.map((r,n)=>{const i=R(r.id),a=`enhanced-table-checkbox-${n}`;return e.jsxs(D,{hover:!0,onClick:s=>w(s,r.id),role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:a,scope:"row",padding:"none",children:r.slno}),e.jsx(u,{align:"right",children:r.date}),e.jsx(u,{align:"right",children:r.trainername}),e.jsx(u,{align:"right",children:r.refrno}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${r.training_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>q(`data:image/png;base64,${r.training_image}`),onError:s=>{s.target.onerror=null}})}),e.jsx(u,{align:"right",children:r.description})]},r.id)}),y>0&&e.jsx(D,{style:{height:53*y},children:e.jsx(u,{colSpan:Me.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:M,onRowsPerPageChange:F})]}),e.jsxs(re,{open:H,onClose:k,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:k,style:{padding:"10px"},children:"Close"})})]})]})}function Se(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function In(d,o){return d==="desc"?(t,c)=>Se(t,c,o):(t,c)=>-Se(t,c,o)}function Dn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const He=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"othertraining",numeric:!0,disablePadding:!1,label:"OTHER TRAINING"},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"trainername",numeric:!0,disablePadding:!1,label:"TRAINER NAME"},{id:"refrno",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"training_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"description",numeric:!0,disablePadding:!1,label:"DESCRIPTION"}];function Le(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:He.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Le.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function Be(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"Other Training"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Be.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function Tn(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState(!1),[H,T]=b.useState(""),[A,C]=b.useState([]);b.useEffect(()=>{(async()=>{try{const i=(await J.get(`/reports/employee/training/?filter=others&employeeId=${o}`)).data.data.OTHERS;console.log("result:",i);const a=i.map((s,x)=>({slno:x+1,othertraining:s.training_name||"NA",date:s.training_date?B(new Date(s.training_date),"dd/MM/yyyy"):"N/A",trainername:s.trainers.map(S=>S.trainer_name).join(", "),refrno:s.training_id,training_image:s.training_image,description:s.about_the_training}));C(a)}catch(n){if(n.isAxiosError&&n.response){console.error(`HTTP error! status: ${n}`);const i=JSON.stringify(n.response.data);console.error("Response body:",i),alert(`Error: ${i}`)}console.error("Error fetching data:",n)}})()},[]);const L=r=>{T(r),$(!0)},q=()=>{$(!1),T("")},k=(r,n)=>{c(h===n&&t==="asc"?"desc":"asc"),l(n)},w=(r,n)=>{const i=g.indexOf(n);let a=[];i===-1?a=a.concat(g,n):i===0?a=a.concat(g.slice(1)):i===g.length-1?a=a.concat(g.slice(0,-1)):i>0&&(a=a.concat(g.slice(0,i),g.slice(i+1))),E(a)},M=(r,n)=>{_(n)},F=r=>{W(parseInt(r.target.value,10)),_(0)},R=r=>g.indexOf(r)!==-1,y=m>0?Math.max(0,(1+m)*f-A.length):0,v=P.useMemo(()=>Dn(A,In(t,h)).slice(m*f,m*f+f),[t,h,m,A,f]),O=()=>{if(!Array.isArray(A)||A.length===0){const i=new z({orientation:"portrait"});i.setFontSize(10),i.text("No data available",20,20),i.save("Other_Training_Report.pdf");return}const r=new z({orientation:"portrait"});let n=20;A.forEach((i,a)=>{if(n>260&&(r.addPage(),n=20),r.setFontSize(9),r.setTextColor(0,0,0),r.setFont(void 0,"bold"),r.text("SL NO.:",10,n),r.setFont(void 0,"normal"),r.text(i!=null&&i.slno?i.slno.toString():"N/A",50,n),n+=7,r.setFont(void 0,"bold"),r.text("OTHER TRAINING:",10,n),r.setFont(void 0,"normal"),r.text((i==null?void 0:i.othertraining)||"N/A",50,n),n+=7,r.setFont(void 0,"bold"),r.text("DATE:",10,n),r.setFont(void 0,"normal"),r.text((i==null?void 0:i.date)||"N/A",50,n),n+=7,r.setFont(void 0,"bold"),r.text("TRAINER NAME:",10,n),r.setFont(void 0,"normal"),r.text((i==null?void 0:i.trainername)||"N/A",50,n),n+=7,r.setFont(void 0,"bold"),r.text("REFERENCE NUMBER:",10,n),r.setFont(void 0,"normal"),r.text((i==null?void 0:i.refrno)||"N/A",50,n),n+=7,r.setFont(void 0,"bold"),r.text("DESCRIPTION:",10,n),r.setFont(void 0,"normal"),r.text((i==null?void 0:i.description)||"N/A",50,n,{maxWidth:140}),n+=10,i!=null&&i.training_image)try{const s=`data:image/png;base64,${i.training_image}`,x=40,S=40;n+S>270&&(r.addPage(),n=20),r.text("IMAGE:",10,n),r.addImage(s,"PNG",50,n,x,S),n+=S+5}catch(s){console.error("Error adding image:",s),r.text("IMAGE: N/A",10,n),n+=7}else r.text("IMAGE: N/A",10,n),n+=7;n+=7,r.line(10,n,200,n),n+=7}),r.save("Other_Training_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(Be,{numSelected:g.length,onPdfDownload:O}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Le,{order:t,orderBy:h,onRequestSort:k,rowCount:A.length}),e.jsxs(ee,{children:[v.map((r,n)=>{const i=R(r.id),a=`enhanced-table-checkbox-${n}`;return e.jsxs(D,{hover:!0,onClick:s=>w(s,r.id),role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:a,scope:"row",padding:"none",children:r.slno}),e.jsx(u,{align:"right",children:r.othertraining}),e.jsx(u,{align:"right",children:r.date}),e.jsx(u,{align:"right",children:r.trainername}),e.jsx(u,{align:"right",children:r.refrno}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${r.training_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>L(`data:image/png;base64,${r.training_image}`),onError:s=>{s.target.onerror=null}})}),e.jsx(u,{align:"right",children:r.description})]},r.id)}),y>0&&e.jsx(D,{style:{height:53*y},children:e.jsx(u,{colSpan:He.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:A.length,rowsPerPage:f,page:m,onPageChange:M,onRowsPerPageChange:F})]}),e.jsxs(re,{open:p,onClose:q,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:H,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:q,style:{padding:"10px"},children:"Close"})})]})]})}function Pe(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function Cn(d,o){return d==="desc"?(t,c)=>Pe(t,c,o):(t,c)=>-Pe(t,c,o)}function Nn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const Ge=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"reference_number",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"accident_image",numeric:!0,disablePadding:!1,label:"IMAGE"},{id:"about",numeric:!0,disablePadding:!1,label:"About"}];function ze(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Ge.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}ze.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function Ue(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"Nearmiss Report"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Ue.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function An(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const a=(await J.get(`/reports/employee/accident/?filter=nearmiss&employeeId=${o}`)).data.data.map((s,x)=>({id:x+1,slno:x+1,reference_number:s.reference_number,date:s.date?B(new Date(s.date),"dd/MM/yyyy"):"N/A",accident_image:s.accident_image,about:s.about}));$(a)}catch(n){if(n.isAxiosError&&n.response){console.error(`HTTP error! status: ${n}`);const i=JSON.stringify(n.response.data);console.error("Response body:",i),alert(`Error: ${i}`)}console.error("Error fetching data:",n)}})()},[]);const L=(r,n)=>{c(h===n&&t==="asc"?"desc":"asc"),l(n)},q=r=>{C(r),T(!0)},k=()=>{T(!1),C("")},w=(r,n)=>{const i=g.indexOf(n);let a=[];i===-1?a=a.concat(g,n):i===0?a=a.concat(g.slice(1)):i===g.length-1?a=a.concat(g.slice(0,-1)):i>0&&(a=a.concat(g.slice(0,i),g.slice(i+1))),E(a)},M=(r,n)=>{_(n)},F=r=>{W(parseInt(r.target.value,10)),_(0)},R=r=>g.indexOf(r)!==-1,y=m>0?Math.max(0,(1+m)*f-p.length):0,v=P.useMemo(()=>Nn(p,Cn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),O=()=>{const r=new z({orientation:"landscape"}),n=[["SL NO.","REFERENCE NUMBER","DATE","IMAGE","ABOUT"]],i=Array.isArray(p)&&p.length>0?p.map(a=>[(a==null?void 0:a.slno)||"N/A",(a==null?void 0:a.reference_number)||"N/A",(a==null?void 0:a.date)||"N/A","",(a==null?void 0:a.about)||"N/A"]):[["N/A","N/A","N/A","N/A","N/A"]];r.autoTable({head:n,body:i,startY:20,theme:"grid",styles:{fontSize:10,cellPadding:8,valign:"middle",halign:"center"},headStyles:{fillColor:[0,102,204],textColor:[255,255,255],halign:"center",fontSize:10},columnStyles:{0:{cellWidth:25},1:{cellWidth:45},2:{cellWidth:30},3:{cellWidth:50},4:{cellWidth:60}},didDrawCell:a=>{var s;if(a.column.index===3&&Array.isArray(p)&&p.length>0){const x=a.row.index;if((s=p[x])!=null&&s.accident_image){const S=`data:image/png;base64,${p[x].accident_image}`,N=a.cell.width,G=a.cell.height;r.addImage(S,"PNG",a.cell.x+2,a.cell.y+2,N-4,G-4)}else r.text("N/A",a.cell.x+a.cell.width/2-5,a.cell.y+a.cell.height/2)}}}),r.save("Nearmiss_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(Ue,{numSelected:g.length,onPdfDownload:O}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(ze,{order:t,orderBy:h,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[v.map((r,n)=>{const i=R(r.id),a=`enhanced-table-checkbox-${n}`;return e.jsxs(D,{hover:!0,onClick:s=>w(s,r.id),role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:a,scope:"row",padding:"none",children:r.slno}),e.jsx(u,{align:"right",children:r.reference_number}),e.jsx(u,{align:"right",children:r.date}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${r.accident_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>q(`data:image/png;base64,${r.accident_image}`),onError:s=>{s.target.onerror=null}})}),e.jsx(u,{align:"right",children:r.about})]},r.id)}),y>0&&e.jsx(D,{style:{height:53*y},children:e.jsx(u,{colSpan:Ge.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:M,onRowsPerPageChange:F})]}),e.jsxs(re,{open:H,onClose:k,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:k,style:{padding:"10px"},children:"Close"})})]})]})}function ye(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function vn(d,o){return d==="desc"?(t,c)=>ye(t,c,o):(t,c)=>-ye(t,c,o)}function wn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const Je=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"reference_number",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"accident_image",numeric:!0,disablePadding:!1,label:"Accident Image"},{id:"about",numeric:!0,disablePadding:!1,label:"About"}];function Ye(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Je.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Ye.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function Xe(d){const{numSelected:o,onPdfDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"Violation Report"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Xe.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function kn(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const a=(await J.get(`/reports/employee/accident/?filter=violation&employeeId=${o}`)).data.data.map((s,x)=>({id:x+1,slno:x+1,reference_number:s.reference_number,date:s.date?B(new Date(s.date),"dd/MM/yyyy"):"N/A",accident_image:s.accident_image,about:s.about}));$(a)}catch(n){if(n.isAxiosError&&n.response){console.error(`HTTP error! status: ${n}`);const i=JSON.stringify(n.response.data);console.error("Response body:",i),alert(`Error: ${i}`)}console.error("Error fetching data:",n)}})()},[]);const L=(r,n)=>{c(h===n&&t==="asc"?"desc":"asc"),l(n)},q=r=>{C(r),T(!0)},k=()=>{T(!1),C("")},w=(r,n)=>{const i=g.indexOf(n);let a=[];i===-1?a=a.concat(g,n):i===0?a=a.concat(g.slice(1)):i===g.length-1?a=a.concat(g.slice(0,-1)):i>0&&(a=a.concat(g.slice(0,i),g.slice(i+1))),E(a)},M=(r,n)=>{_(n)},F=r=>{W(parseInt(r.target.value,10)),_(0)},R=r=>g.indexOf(r)!==-1,y=m>0?Math.max(0,(1+m)*f-p.length):0,v=P.useMemo(()=>wn(p,vn(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),O=()=>{const r=new z;r.autoTable({head:[["SL NO.","REFERENCE NUMBER","DATE"]],body:p.map(n=>[n.slno,n.reference_number,n.date])}),r.save("Employee_Violation_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(Xe,{numSelected:g.length,onPdfDownload:O}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Ye,{order:t,orderBy:h,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[v.map((r,n)=>{const i=R(r.id),a=`enhanced-table-checkbox-${n}`;return e.jsxs(D,{hover:!0,onClick:s=>w(s,r.id),role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:a,scope:"row",padding:"none",children:r.slno}),e.jsx(u,{align:"right",children:r.reference_number}),e.jsx(u,{align:"right",children:r.date}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${r.accident_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>q(`data:image/png;base64,${r.accident_image}`),onError:s=>{s.target.onerror=null}})}),e.jsx(u,{align:"right",children:r.about})]},r.id)}),y>0&&e.jsx(D,{style:{height:53*y},children:e.jsx(u,{colSpan:Je.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:M,onRowsPerPageChange:F})]}),e.jsxs(re,{open:H,onClose:k,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:k,style:{padding:"10px"},children:"Close"})})]})]})}function Re(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function On(d,o){return d==="desc"?(t,c)=>Re(t,c,o):(t,c)=>-Re(t,c,o)}function $n(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}const Ve=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO."},{id:"reference_number",numeric:!0,disablePadding:!1,label:"REFERENCE NUMBER"},{id:"date",numeric:!0,disablePadding:!1,label:"DATE"},{id:"permit_status",numeric:!0,disablePadding:!1,label:"PermitStatus"},{id:"ppe_status",numeric:!0,disablePadding:!1,label:"PPE Status"},{id:"severity_id",numeric:!0,disablePadding:!1,label:"Severity Id"},{id:"severity",numeric:!0,disablePadding:!1,label:"Severity"},{id:"toolbox_training",numeric:!0,disablePadding:!1,label:"ToolBoxTalk"},{id:"toolbox_training_reference_number",numeric:!0,disablePadding:!1,label:"ToolBoxTalkRefNo."},{id:"accident_image",numeric:!0,disablePadding:!1,label:"Accident Image"},{id:"about",numeric:!0,disablePadding:!1,label:"About"}];function Ke(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Ve.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Ke.propTypes={order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired,onRequestSort:j.func.isRequired};function Qe(d){const{numSelected:o,onPDFDownload:t}=d;return e.jsxs(de,{children:[e.jsx(V,{sx:{flex:"1 1 100%",textAlign:"center"},variant:"h6",id:"tableTitle",component:"div",children:"Accident Report"}),e.jsx(I,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:e.jsx(e.Fragment,{children:e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:t,children:e.jsx(Y,{})})})})})]})}Qe.propTypes={numSelected:j.number.isRequired,onPdfDownload:j.func.isRequired};function qn(d){const o=d.employee_id,[t,c]=P.useState("asc"),[h,l]=P.useState("slno"),[g,E]=P.useState([]),[m,_]=P.useState(0),[f,W]=P.useState(5),[p,$]=b.useState([]),[H,T]=b.useState(!1),[A,C]=b.useState("");b.useEffect(()=>{(async()=>{try{const a=(await J.get(`/reports/employee/accident/?filter=accident&employeeId=${o}`)).data.data.map((s,x)=>({id:x+1,slno:x+1,reference_number:s.reference_number,date:s.date?B(new Date(s.date),"dd/MM/yyyy"):"N/A",permit_status:s.permit_status,ppe_status:s.ppe_status,severity:s.severity,severity_id:s.severity_id,accident_image:s.accident_image,toolbox_training:s.toolbox_training,toolbox_training_reference_number:s.toolbox_training_reference_number,about:s.about}));$(a)}catch(n){if(n.isAxiosError&&n.response){console.error(`HTTP error! status: ${n}`);const i=JSON.stringify(n.response.data);console.error("Response body:",i),alert(`Error: ${i}`)}console.error("Error fetching data:",n)}})()},[]);const L=(r,n)=>{c(h===n&&t==="asc"?"desc":"asc"),l(n)},q=r=>{C(r),T(!0)},k=()=>{T(!1),C("")},w=(r,n)=>{const i=g.indexOf(n);let a=[];i===-1?a=a.concat(g,n):i===0?a=a.concat(g.slice(1)):i===g.length-1?a=a.concat(g.slice(0,-1)):i>0&&(a=a.concat(g.slice(0,i),g.slice(i+1))),E(a)},M=(r,n)=>{_(n)},F=r=>{W(parseInt(r.target.value,10)),_(0)},R=r=>g.indexOf(r)!==-1,y=m>0?Math.max(0,(1+m)*f-p.length):0,v=P.useMemo(()=>$n(p,On(t,h)).slice(m*f,m*f+f),[t,h,m,p,f]),O=()=>{const r=new z({orientation:"portrait",unit:"mm",format:"a4"});let n=20;const i=7,a=10,s=10;if(r.setFontSize(10),!Array.isArray(p)||p.length===0){r.text("No Data Available",s,n),r.save("Accident_Report.pdf");return}p.forEach((x,S)=>{if(n+50>r.internal.pageSize.height&&(r.addPage(),n=20),r.text(`SL NO.: ${x.slno||"N/A"}`,s,n),r.text(`REFERENCE NUMBER: ${x.reference_number||"N/A"}`,s,n+i),r.text(`DATE: ${x.date||"N/A"}`,s,n+i*2),r.text(`Permit Status: ${x.permit_status||"N/A"}`,s,n+i*3),r.text(`PPE Status: ${x.ppe_status||"N/A"}`,s,n+i*4),r.text(`Severity ID: ${x.severity_id||"N/A"}`,s,n+i*5),r.text(`Severity: ${x.severity||"N/A"}`,s,n+i*6),r.text(`About: ${x.about||"N/A"}`,s,n+i*7),r.text(`ToolBox Talk: ${x.toolbox_training||"N/A"}`,s,n+i*8),r.text(`ToolBox Reference: ${x.toolbox_training_reference_number||"N/A"}`,s,n+i*9),x.accident_image){const N=`data:image/png;base64,${x.accident_image}`;r.text("Image:",s,n+i*10),r.addImage(N,"PNG",s+25,n+i*10,30,30),n+=40}else r.text("No Image Available",s,n+i*10);n+=a+i*10}),r.save("Accident_Report.pdf")};return e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsx(Qe,{numSelected:g.length,onPDFDownload:O}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Ke,{order:t,orderBy:h,onRequestSort:L,rowCount:p.length}),e.jsxs(ee,{children:[v.map((r,n)=>{const i=R(r.id),a=`enhanced-table-checkbox-${n}`;return e.jsxs(D,{hover:!0,onClick:s=>w(s,r.id),role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",id:a,scope:"row",padding:"none",children:r.slno}),e.jsx(u,{align:"right",children:r.reference_number}),e.jsx(u,{align:"right",children:r.date}),e.jsx(u,{align:"right",children:r.permit_status}),e.jsx(u,{align:"right",children:r.ppe_status}),e.jsx(u,{align:"right",children:r.severity_id}),e.jsx(u,{align:"right",children:r.severity}),e.jsx(u,{align:"right",children:r.toolbox_training}),e.jsx(u,{align:"right",children:r.toolbox_training_reference_number}),e.jsx(u,{align:"right",children:e.jsx("img",{src:`data:image/png;base64,${r.accident_image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>q(`data:image/png;base64,${r.accident_image}`),onError:s=>{s.target.onerror=null}})}),e.jsx(u,{align:"right",children:r.about})]},r.id)}),y>0&&e.jsx(D,{style:{height:53*y},children:e.jsx(u,{colSpan:Ve.length})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:f,page:m,onPageChange:M,onRowsPerPageChange:F})]}),e.jsxs(re,{open:H,onClose:k,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:A,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:k,style:{padding:"10px"},children:"Close"})})]})]})}const Mn=[{id:"slno",numeric:!1,disablePadding:!0,label:"SL NO"},{id:"employee_id",numeric:!0,disablePadding:!1,label:"Employee Code"},{id:"employee_name",numeric:!0,disablePadding:!1,label:"Employee Name"},{id:"checkup_date",numeric:!0,disablePadding:!1,label:"Checkup Date"},{id:"image",numeric:!0,disablePadding:!1,label:"Image"}];function Ze(d){const{order:o,orderBy:t,onRequestSort:c}=d,h=l=>g=>{c(g,l)};return e.jsx(ne,{children:e.jsx(D,{children:Mn.map(l=>e.jsx(u,{align:l.numeric?"right":"left",padding:l.disablePadding?"none":"normal",sortDirection:t===l.id?o:!1,children:e.jsxs(ie,{active:t===l.id,direction:t===l.id?o:"asc",onClick:h(l.id),children:[l.label,t===l.id?e.jsx(I,{component:"span",sx:ae,children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}Ze.propTypes={onRequestSort:j.func.isRequired,order:j.oneOf(["asc","desc"]).isRequired,orderBy:j.string.isRequired};function Ee(d,o,t){return o[t]<d[t]?-1:o[t]>d[t]?1:0}function Fn(d,o){return d==="desc"?(t,c)=>Ee(t,c,o):(t,c)=>-Ee(t,c,o)}function Wn(d,o){const t=d.map((c,h)=>[c,h]);return t.sort((c,h)=>{const l=o(c[0],h[0]);return l!==0?l:c[1]-h[1]}),t.map(c=>c[0])}function Hn(d){const o=d.employee_id,[t,c]=b.useState("asc"),[h,l]=b.useState("employee_id"),[g,E]=b.useState(0),[m,_]=b.useState(5),[f,W]=b.useState([]),[p,$]=b.useState(!1),[H,T]=b.useState("");b.useEffect(()=>{(async()=>{var y,v;try{const n=(await J.get(`/reports/employee/medicalcheckup/?employeeId=${o}`)).data.data.map((i,a)=>({id:a+1,slno:a+1,employee_id:i.employee_id,employee_name:i.employee_name,checkup_date:i.checkup_date?B(new Date(i.checkup_date),"dd/MM/yyyy"):"N/A",image:i.image}));W(n)}catch(O){console.error("Error fetching data:",O);const r=((v=(y=O.response)==null?void 0:y.data)==null?void 0:v.message)||O.message||"Something went wrong. Please try again later.";alert(` ${r}`)}})()},[o]);const A=(R,y)=>{c(h===y&&t==="asc"?"desc":"asc"),l(y)},C=(R,y)=>{E(y)},L=R=>{_(parseInt(R.target.value,10)),E(0)},q=()=>{const R=new z;R.autoTable({head:[["SL NO","Employee Code","Employee Name","Checkup Date","Image"]],body:f.map(y=>[y.slno,y.employee_id,y.employee_name,y.checkup_date,y.image])}),R.save("medical-checkup-reports.pdf")},k=R=>{T(R),$(!0)},w=()=>{$(!1),T("")},M=g>0?Math.max(0,(1+g)*m-f.length):0,F=Wn(f,Fn(t,h)).slice(g*m,g*m+m);return e.jsxs(I,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsxs(X,{sx:{width:"100%",mb:2,padding:5},children:[e.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsx(V,{variant:"h6",id:"tableTitle",component:"div",children:"Medical Checkup Report"}),e.jsx(se,{title:"Download PDF",children:e.jsx(K,{onClick:q,children:e.jsx(Y,{})})})]}),e.jsx(Q,{children:e.jsxs(Z,{sx:{minWidth:730},"aria-labelledby":"tableTitle",children:[e.jsx(Ze,{order:t,orderBy:h,onRequestSort:A}),e.jsxs(ee,{children:[F.map(R=>e.jsxs(D,{hover:!0,sx:{cursor:"pointer"},children:[e.jsx(u,{children:R.slno}),e.jsx(u,{align:"right",children:R.employee_id}),e.jsx(u,{align:"right",children:R.employee_name}),e.jsx(u,{align:"right",children:R.checkup_date}),e.jsx(u,{align:"center",children:e.jsx("img",{src:`data:image/png;base64,${R.image}`,alt:"Image Not Found ",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"5px",cursor:"pointer"},onClick:()=>k(`data:image/png;base64,${R.image}`),onError:y=>{y.target.onerror=null}})})]},R.id)),M>0&&e.jsx(D,{style:{height:53*M},children:e.jsx(u,{colSpan:5})})]})]})}),e.jsx(te,{rowsPerPageOptions:[5,10,25],component:"div",count:f.length,rowsPerPage:m,page:g,onPageChange:C,onRowsPerPageChange:L})]}),e.jsxs(re,{open:p,onClose:w,children:[e.jsx(le,{children:"Image Preview"}),e.jsx(oe,{children:e.jsx("img",{src:H,alt:"Preview",style:{width:"400px",height:"300px",objectFit:"cover"}})}),e.jsx(ce,{children:e.jsx("button",{onClick:w,style:{padding:"10px"},children:"Close"})})]})]})}function at(){const[d]=en(),o=d.get("employeeid"),t=nn(),c=()=>{t(-1)};return e.jsxs(e.Fragment,{children:[e.jsxs(ue,{className:"align-items-center",children:[e.jsx(ge,{xs:"auto",children:e.jsx(tn,{color:"link",onClick:c,children:e.jsx(sn,{icon:an,size:"xl"})})}),e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"ITEM-DETAILS"})}),e.jsxs(ge,{xs:"auto",className:"text-end",children:[e.jsxs("h5",{style:{color:"white",fontWeight:"bold",margin:0,fontSize:"1.25rem"},children:["Employee_Id ",o]})," "]})]}),e.jsx(pn,{employee_id:o}),e.jsx(hn,{employee_id:o}),e.jsx(on,{employee_id:o}),e.jsx("hr",{}),e.jsx(ue,{children:e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"Safety Training Details"})})}),e.jsx(jn,{employee_id:o}),e.jsx(yn,{employee_id:o}),e.jsx(_n,{employee_id:o}),e.jsx(Tn,{employee_id:o}),e.jsx("hr",{}),e.jsx(ue,{children:e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"Nearmiss Report"})})}),e.jsx(An,{employee_id:o}),e.jsx("hr",{}),e.jsx(ue,{children:e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"Accident Report"})})}),e.jsx(qn,{employee_id:o}),e.jsx("hr",{}),e.jsx(ue,{children:e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"Violation Report"})})}),e.jsx(kn,{employee_id:o}),e.jsx(ue,{children:e.jsx(ge,{className:"text-center",children:e.jsx("h2",{style:{color:"whitesmoke"},children:"Medical Checkup Report"})})}),e.jsx(Hn,{employee_id:o})]})}export{at as default};
